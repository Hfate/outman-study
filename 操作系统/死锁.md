# 死锁
    
## **资源**
  
    把需要排他性使用的对象称之为资源；简单来说资源就是随着时间推移，必须能获得，使用以及释放的任何东西
    
## 简介
    
   **定义**
   如果一个进程集合中的每个进程都在等待只能由该进程集合中的其他进程才能引发的事件，那么该进程集合就是死锁的
   
   **资源死锁条件**
   + **互斥条件** 每个资源要么已经分配给了一个进程，要么就是可用的
   + **占有和等待条件** 已经得到某个资源的进程可以再请求其他资源
   + **不可抢占条件** 已经分配给一个进程的资源不能强制性地被抢占，它只能被占有它的进程显示的释放。
   + **环路等待条件** 死锁发生时，系统中一定有有两个或两个以上进程组成一条环路，该环路中的每个进程都在等待下一个进程所占有的资源
  
   以上四个条件同时满足，死锁才会发生；如果其中任意一个条件不成立，死锁都不会发生

## 鸵鸟算法
   
    假装问题根本没发生，把头埋进沙子里

## 死锁检测和死锁恢复

### 每种资源类型一个资源的死锁检测
   
   每种资源类型只有一个资源，例如系统有扫描仪，绘图仪，打印机等等，每种设备不超过一个，即排除有两台打印机的情况。
   
   **一般环路检测算法**
   1. 构造一张资源分配图
   2. 对图中的每个节点N，将N作为起始节点，可以执行以下步骤
   3. 将L初始化为空表，并清除所有有向边标记
   4. 将当前节点添加到L的尾部，并检测该节点在L中是否出现过两次。如果是，那么该图包换环，算法结束
   5. 从给定的节点开始，检测是否存在没有标记的从该节点出发的弧（有向边）。如果存在的话，做第6步；如果不存在做第7步
   6. 随机选取一条没有标记的从该节点出发的弧（有向边），标记它。然后顺着这条弧线找到新的当前节点，返回第3步
   7. 如果这一节点是起始节点，那么表明该图不存在任何环，算法结束。否则意味着走进了死胡同，所以需要移走当前节点，返回到前一个节点，并将其作为当前节点，同时转到第3步

### 每种资源类型多个资源的死锁检测
   
    。。。。

###死锁恢复
   
  + 利用抢占恢复
    
     在某些情况下，可能会临时将某个资源从它的当前所有者那里转移给另一个进程。
      
  + 利用回滚恢复
     
     周期性的进行检查点点检查，进程检查点检查就是将进程的状态写入一个文件以备以后重启。
  
  + 通过杀死进程恢复
   
### 死锁避免
   + 资源轨迹图
   + 安全状态与不安全状态
   + 单个资源的银行家算法

### 死锁预防
   
   + 破坏互斥条件
      
      如果一个资源不被一个进程独占，那么死锁肯定不会发生
  
   + 破坏占用并等待条件
      
      只要禁止已持有资源的进程再等待其他资源并可以消除死锁。两种方案：
      1. 规定所有进程在开始执行前请求所需的所有资源
      2. 规定当一个进程请求资源时，先暂时释放已占用资源，然后再尝试一次获取所需资源
   
   + 破坏不可抢占条件
      
   + 破坏环路等待条件
      
      1. 保证每一个进程在任何时刻都只占用一个资源，如果要请求另一个资源，必须释放第一个资源
      2. 将所有资源编号；进程可以在任何时刻提出资源请求，但所有请求必须按照资源的顺序提出；
      
      

   

    
